---
import { Icon } from 'astro-icon/components';

export interface Props {
  lang: string;
}

const { lang } = Astro.props;
const label = lang === 'en' ? 'PT-BR' : 'EN';
---

<button
  id="lang-switch"
  data-lang={lang}
  class="flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-100 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm border border-gray-200/50 dark:border-blue-500/30 hover:bg-gray-100/80 dark:hover:bg-blue-500/20 transition-all duration-300 shadow-lg justify-center cursor-pointer dark:text-gray-200 text-slate-600 font-medium"
  aria-label={`Switch language to ${label}`}
>
  <Icon name="mdi:earth" />
  <span>{label}</span>
</button>

<script>
  document.addEventListener('astro:page-load', () => {
    const button = document.getElementById('lang-switch');
    if (button) {
      button.addEventListener('click', () => {
        const currentLang = button.dataset.lang;
        const nextLang = currentLang === 'en' ? 'pt-br' : 'en';
        const newPath = window.location.pathname.replace(
          /^\/(en|pt-br|pt)/,
          '',
        );
        window.location.href = `/${nextLang}${newPath}`;
      });
    }
  });
</script>
